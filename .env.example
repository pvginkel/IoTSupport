# iot-support Environment Configuration
#
# Copy this file to .env and update values as needed.
# All values shown are defaults.

# ── Core Settings ─────────────────────────────────────────────────────

# Flask environment: development, testing, production
FLASK_ENV=development

# Debug mode (disable in production)
DEBUG=true

# Secret key for Flask sessions (MUST be changed in production)
SECRET_KEY=dev-secret-key-change-in-production

# Allowed CORS origins (comma-separated in env, JSON list in code)
CORS_ORIGINS=["http://localhost:3100"]

# ── Background Tasks ─────────────────────────────────────────────────

# Maximum number of concurrent background task workers
TASK_MAX_WORKERS=4

# Task execution timeout in seconds
TASK_TIMEOUT_SECONDS=300

# How often to clean up completed tasks (seconds)
TASK_CLEANUP_INTERVAL_SECONDS=600

# ── Metrics ───────────────────────────────────────────────────────────

# Background metrics update interval in seconds
METRICS_UPDATE_INTERVAL=60

# ── Shutdown ──────────────────────────────────────────────────────────

# Maximum seconds to wait for tasks during graceful shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=600

# Bearer token for authenticating drain endpoint access
DRAIN_AUTH_KEY=

# ── Database (use_database) ───────────────────────────────────────────

# PostgreSQL connection string
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/iot-support

# Connection pool settings
DB_POOL_SIZE=20
DB_POOL_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=10
DB_POOL_ECHO=false

# Request diagnostics (query timing and profiling)
DIAGNOSTICS_ENABLED=false
DIAGNOSTICS_SLOW_QUERY_THRESHOLD_MS=100
DIAGNOSTICS_SLOW_REQUEST_THRESHOLD_MS=500
DIAGNOSTICS_LOG_ALL_QUERIES=false

# ── OIDC Authentication (use_oidc) ───────────────────────────────────

# Base URL for the application (used for redirect URI and cookie security)
BASEURL=http://localhost:3100

# Enable/disable OIDC authentication
OIDC_ENABLED=false

# OIDC provider settings
OIDC_ISSUER_URL=https://auth.example.com/realms/myapp
OIDC_CLIENT_ID=my-backend
OIDC_CLIENT_SECRET=
OIDC_SCOPES=openid profile email
OIDC_AUDIENCE=

# Token validation
OIDC_CLOCK_SKEW_SECONDS=30

# Cookie settings
OIDC_COOKIE_NAME=access_token
OIDC_COOKIE_SECURE=
OIDC_COOKIE_SAMESITE=Lax
OIDC_REFRESH_COOKIE_NAME=refresh_token
